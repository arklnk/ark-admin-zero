syntax = "v1"

info(
	title: "部门"
	desc: "部门"
	author: "Trevor"
	email: "trevorlan@163.com"
)

type (
	Dept {
		Id        uint64 `json:"id"`
		ParentId  uint64 `json:"parentId"`
		Name      string `json:"name"`
		FullName  string `json:"fullName"`
		UniqueKey string `json:"uniqueKey"`
		Type      uint64 `json:"type"`
		Status    uint64 `json:"status"`
		OrderNum  uint64 `json:"orderNum"`
		Remark    string `json:"remark"`
	}
	SysDeptListResp {
		DeptList []Dept `json:"list"`
	}
)

type (
	AddSysDeptReq {
		ParentId  uint64 `json:"parentId"   validate:"number,gte=0"`
		Name      string `json:"name"       validate:"min=2,max=50"`
		FullName  string `json:"fullName"   validate:"omitempty,min=2,max=50"`
		UniqueKey string `json:"uniqueKey"  validate:"min=2,max=50"`
		Type      uint64 `json:"type"       validate:"number,gte=1,lte=3"`
		Status    uint64 `json:"status"     validate:"number,gte=0,lte=1"`
		OrderNum  uint64 `json:"orderNum"   validate:"number,gte=0,lte=9999"`
		Remark    string `json:"remark"     validate:"max=200"`
	}
)

type (
	DeleteSysDeptReq {
		Id uint64 `json:"id"  validate:"number,gte=1"`
	}
)

type (
	UpdateSysDeptReq {
		Id        uint64 `json:"id"         validate:"number,gte=1"`
		ParentId  uint64 `json:"parentId"   validate:"number,gte=0"`
		Name      string `json:"name"       validate:"min=2,max=50"`
		FullName  string `json:"fullName"   validate:"omitempty,min=2,max=50"`
		UniqueKey string `json:"uniqueKey"  validate:"min=2,max=50"`
		Type      uint64 `json:"type"       validate:"number,gte=1,lte=3"`
		Status    uint64 `json:"status"     validate:"number,gte=0,lte=1"`
		OrderNum  uint64 `json:"orderNum"   validate:"number,gte=0,lte=9999"`
		Remark    string `json:"remark"     validate:"max=200"`
	}
)

@server(
	jwt: JwtAuth
	group : sys/dept
	prefix : /sys/dept
	middleware: PermMenuAuth
)
service core-api {
	@doc(
		summary: "部门列表"
	)
	@handler GetSysDeptList
	get /list returns (SysDeptListResp)
	
	@doc(
		summary: "新增部门"
	)
	@handler AddSysDept
	post /add (AddSysDeptReq)
	
	@doc(
		summary: "删除部门"
	)
	@handler DeleteSysDept
	post /delete (DeleteSysDeptReq)
	
	@doc(
		summary: "更新部门"
	)
	@handler UpdateSysDept
	post /update (UpdateSysDeptReq)
}